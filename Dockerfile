FROM testcafe/testcafe:1.11.0
LABEL maintainer="Daniel Rataj <daniel.rataj@centrum.cz>"
LABEL org.opencontainers.image.source="https://github.com/whoopsmonitor/whoopsmonitor-check-testcafe"

LABEL com.whoopsmonitor.documentation="https://github.com/whoopsmonitor/whoopsmonitor-check-testcafe"
LABEL com.whoopsmonitor.icon="data:image/png;base64,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"

ENV WM_CHECK_ID=${WM_CHECK_ID:-NOT_DEFINED}
ENV WM_BROWSER=${WM_BROWSER:-chromium}
ENV WM_ORIGINAL_ENTRYPOINT=/opt/testcafe/docker/testcafe-docker.sh
ENV WM_WORKER_DIR=/whoopsmonitor-worker

USER root

COPY entrypoint.sh /opt/whoopsmonitor-check-testcafe/entrypoint.sh
RUN chmod +x /opt/whoopsmonitor-check-testcafe/entrypoint.sh

USER user

ENTRYPOINT ["/opt/whoopsmonitor-check-testcafe/entrypoint.sh"]
